
<div class="list_container">
    <div class="title">
        <%= button_to 'Crea chat', create_path, method: :post, data: { confirm: 'Are you sure?' }, class: 'crea' %>
    </div>
    <div class="list">
            <%= render partial: "home/chat_list" %>
    </div>             
</div>


<div class="chat-area">
    <div class="chat-header">
        <b id="nome-chat"><%= @chat_name %></b>
        <div id="nome-modello"><%= @ai_model %></div>
    </div>

    <div class="chatflow_container">

        <ul class="chatflow">

            <li class="chatbox incoming">
                <p>Hi there ðŸ‘‹, how can I help you? <br> Ask me anything ...</p>
            </li>

            <% @messages.each_with_index do |message, index| %>
                <% if message.message_type == 0 %>
                    <li class="chatbox outgoing">
                        <%= button_to '', delete_message_path(message), method: :delete, class: 'btn-close' %>
                        <!-- aggiunge il bottone reload solo all'ultimo messaggio -->
                        <% if index == @messages.rindex { |m| m.message_type == 0 } %>
                            <button type="button" class="reload-button" id="reload_button">
                                <%= image_tag('reload.svg', alt: "") %>
                            </button>
                        <% end %>
                        <p><%= message.content %></p>
                    </li>
                <% else %>
                    <li class="chatbox incoming">
                        <p><%= message.content %></p>
                    </li>
                <% end %>
            <% end %>

        </ul>
    </div>
</div>




<div class="user-area">
        <div class="user-input-container">
            <%= form_tag('/send_msg', method: :post, id: "user_input_form") do %>
                <%= text_area_tag :user_input, "", id: "user_input" %>
                <%= hidden_field_tag :translate, 'false', id: 'translate_input' %>
                <%= hidden_field_tag :reload, 'false', id: 'reload_input' %>
            <% end %>
        </div>
        
        <div class="commands-grid">

            <button type="button" class="button input-button" id="send_button">
                <%= image_tag('send.png', alt: "", class: "button-img") %>
            </button>

            
            <button type="button" class="button input-button dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" id="translate_button">
                <%= image_tag('globe.png', alt: "", class: "button-img") %>
            </button>
            <ul class="dropdown-menu">
                <li><button class="dropdown-item" id="translate-ita">Italiano ðŸ‡®ðŸ‡¹</button></li>
                <li><button class="dropdown-item" id="translate-sp">Spagnolo ðŸ‡ªðŸ‡¦</button></li>
                <li><button class="dropdown-item" id="translate-fr">Francese ðŸ‡«ðŸ‡·</button></li>
                <li><button class="dropdown-item" id="translate-de">Tedesco ðŸ‡©ðŸ‡ª</button></li>
            </ul>


            <button type="button" class="button input-button dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false" id="aimodel_button">
                <%= image_tag('model-ai.png', alt: "", class: "button-img") %>
            </button>
            <ul class="dropdown-menu">
                <li><%= link_to 'Mixtral 8x7b (Mistral)', set_aimodel_path('mixtral'), class: 'dropdown-item' %></li>
                <li><%= link_to 'Gemma 7b (Google)', set_aimodel_path('gemma'), class: 'dropdown-item' %></li>
                <li><%= link_to 'LLaMA3 70b (Meta)', set_aimodel_path('llama3-70b'), class: 'dropdown-item' %></li>
                <li><%= link_to 'LLaMA3 8b (Meta)', set_aimodel_path('llama3-8b'), class: 'dropdown-item' %></li>
            </ul>


        </div>


</div>

<%= javascript_include_tag "home.js" %>